
@using MonitoringConfigurator.Services
@{
    ViewData["Title"] = "Wynik konfiguracji";
    var res = (ConfigResult)ViewBag.Result;
}

<h2 class="d-flex align-items-center justify-content-between">
    <span>Wynik konfiguracji</span>
    <span class="d-flex gap-2">
        <a class="btn btn-danger" asp-controller="Configurator" asp-action="ExportPdf">
            <i class="bi bi-filetype-pdf"></i> Pobierz PDF
        </a>
        <a class="btn btn-outline-primary" asp-controller="Configurator" asp-action="ExportDocx">
            <i class="bi bi-filetype-docx"></i> Pobierz Word
        </a>
    </span>
</h2>

<div class="row g-3">
    <div class="col-md-4">
        <div class="card h-100">
            <div class="card-body">
                <div class="title mb-1">Kamera</div>
                @if (res.Camera == null)
                {
                    <div class="text-muted">Nie dobrano kamery.</div>
                }
                else
                {
                    <div>@res.Camera?.Name</div>
                    <div class="small text-muted">@res.Camera?.Brand @res.Camera?.Model</div>
                    <div class="small">Rozdzielczość: <strong>@res.Camera?.ResolutionMp MP</strong></div>
                    <div class="small">IR: <strong>@res.Camera?.IrRangeM m</strong></div>
                    <div class="small">Ilość kamer: <strong>@res.CameraCount</strong></div>
                }
            </div>
        </div>
    </div>

    <div class="col-md-4">
        <div class="card h-100">
            <div class="card-body">
                <div class="title mb-1">Rejestrator (NVR)</div>
                @if (res.Nvr == null)
                {
                    <div class="text-muted">Nie dobrano rejestratora.</div>
                }
                else
                {
                    <div>@res.Nvr?.Name</div>
                    <div class="small text-muted">@res.Nvr?.Brand @res.Nvr?.Model</div>
                    <div class="small">Kanały: <strong>@res.Nvr?.Channels</strong></div>
                    <div class="small">Przepustowość: <strong>@res.Nvr?.MaxBandwidthMbps Mbps</strong></div>
                }
            </div>
        </div>
    </div>

    <div class="col-md-4">
        <div class="card h-100">
            <div class="card-body">
                <div class="title mb-1">Switch PoE</div>
                @if (res.Switch == null)
                {
                    <div class="text-muted">Nie dobrano switcha PoE.</div>
                }
                else
                {
                    <div>@res.Switch?.Name</div>
                    <div class="small">Porty: <strong>@res.Switch?.Ports</strong>, Budżet PoE: <strong>@res.Switch?.PoeBudgetW W</strong></div>
                }
            </div>
        </div>
    </div>
</div>

<div class="row g-3 mt-2">
    <div class="col-md-6">
        <div class="card h-100">
            <div class="card-body">
                <div class="title mb-1">Magazyn (HDD)</div>
                @if (!res.Hdds.Any())
                {
                    <div class="text-muted">Brak doboru dysków.</div>
                }
                else
                {
                    <ul class="mb-0">
                        @foreach (var h in res.Hdds) { <li>@h.Product.Name — <strong>@h.Product.StorageTB TB</strong> x @h.Qty</li> }
                    </ul>
                }
            </div>
        </div>
    </div>

    <div class="col-md-6">
        <div class="card h-100">
            <div class="card-body">
                <div class="title mb-1">Kabel</div>
                
                @if (res.CableRolls == null)
                {
                    <div class="text-muted">Nie dobrano kabla.</div>
                }
                else
                {
                    <ul class="mb-0">
                        <li>@res.CableRolls.Product.Name — rolka <strong>@res.CableRolls.Product.RollLengthM m</strong> x @res.CableRolls.Qty</li>
                    </ul>
                }
             
            </div>
        </div>
    </div>
</div>

<div class="row g-3 mt-2">
    <div class="col-md-6">
        <div class="card h-100">
            <div class="card-body">
                <div class="title mb-1">UPS</div>
                @if (res.Ups == null)
                {
                    <div class="text-muted">Brak doboru UPS.</div>
                }
                else
                {
                    <div>@res.Ups.Name</div>
                    <div class="small">Moc: <strong>@res.Ups.UpsVA VA</strong></div>
                }
            </div>
        </div>
    </div>
    <div class="col-md-6">
        <div class="card h-100">
            <div class="card-body">
                <div class="title mb-1">Podsumowanie</div>
                <div>Sumaryczny bitrate: <strong>@res.TotalBandwidthMbps Mbps</strong></div>
                <div>Szacowana pojemność: <strong>@res.TotalStorageTB TB</strong></div>
                <div>Wymagany budżet PoE: <strong>@res.TotalPoeW W</strong></div>
                <div class="mt-2">Cena orientacyjna: <strong>@res.TotalPrice.ToString("C")</strong></div>
            </div>
        </div>
    </div>
</div>

@{
    TempData.Keep("LastInput");
    TempData.Keep("LastResult");
    TempData.Keep("LastGeneratedAt");
}

<style>
.title{font-weight:600}
.card{background:#151518;border:1px solid #2b2b2b;color:#e5e7eb}
h2{color:#e5e7eb}
body{background:#0d0f12}
.btn-danger{background:#ff3b30;border-color:#ff3b30}
</style>
